facet_wrap(~soil_type)
ggplot()+
geom_point(aes(Cc, sum_vRoot), colour = "#21918c",
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "other"))+
geom_point(aes(Cc, sum_vRoot), colour = "#440154" ,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_point(aes(Cc, y = sum_vRoot), colour = "#fde725", data = end_engi)+
facet_wrap(~soil_type)+
theme_dark()
ggplot()+
geom_point(aes(Cc, sum_vRoot), colour = "#21918c",
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "other"))+
geom_point(aes(Cc, sum_vRoot), colour = "#440154" ,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_point(aes(Cc, y = sum_vRoot), colour = "#fde725", data = end_engi)+
facet_wrap(~soil_type)+
theme_classic()
ggplot()+
geom_point(aes(Cc, sum_vRoot), colour = "#21918c", alpha = 0.3,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "other"))+
geom_point(aes(Cc, sum_vRoot), colour = "#440154" ,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_point(aes(Cc, y = sum_vRoot), colour = "#fde725", data = end_engi)+
facet_wrap(~soil_type)+
theme_classic()
ggplot()+
geom_point(aes(Cc, sum_vRoot), colour = "#21918c", alpha = 0.1,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "other"))+
geom_point(aes(Cc, sum_vRoot), colour = "#440154" ,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_point(aes(Cc, y = sum_vRoot), colour = "#fde725", data = end_engi)+
facet_wrap(~soil_type)+
theme_classic()
ggplot()+
geom_point(aes(Cc, sum_vRoot), colour = "#21918c", alpha = 0.1,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "other"))+
geom_point(aes(Cc, sum_vRoot), colour = "#440154" , alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_point(aes(Cc, y = sum_vRoot), colour = "#fde725", data = end_engi)+
facet_wrap(~soil_type)+
theme_classic()
ggplot()+
geom_point(aes(Cc, sum_vRoot), colour = "#21918c", alpha = 0.1,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "other"))+
geom_point(aes(Cc, sum_vRoot), colour = "#440154" , alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_point(aes(Cc, y = sum_vRoot), colour = "red", data = end_engi)+
facet_wrap(~soil_type)+
theme_classic()
ggplot()+
geom_point(aes(Cc, sum_vRoot), colour = "#21918c", alpha = 0.1,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "other"))+
geom_point(aes(Cc, sum_vRoot), colour = "#440154" , alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_point(aes(Cc, y = sum_vRoot), colour = "red", alpha = 0.6 data = end_engi)+
ggplot()+
geom_point(aes(Cc, sum_vRoot), colour = "#21918c", alpha = 0.1,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "other"))+
geom_point(aes(Cc, sum_vRoot), colour = "#440154" , alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_point(aes(Cc, y = sum_vRoot), colour = "red", alpha = 0.6, data = end_engi)+
facet_wrap(~soil_type)+
theme_classic()
ggplot()+
geom_point(aes(Cc, sum_vRoot), colour = "#21918c", alpha = 0.1,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "other"))+
geom_point(aes(Cc, sum_vRoot), colour = "#440154" , alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_boxplot(aes(x = mean(Cc), y = sum_vRoot), colour = "red", alpha = 0.6, data = end_engi)+
facet_wrap(~soil_type)+
theme_classic()
ggplot()+
geom_point(aes(Cc, sum_vRoot), colour = "#21918c", alpha = 0.1,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "other"))+
geom_point(aes(Cc, sum_vRoot), colour = "#440154" , alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_boxplot(aes(Cc, y = sum_vRoot), colour = "red", alpha = 0.6, data = end_engi)+
facet_wrap(~soil_type)+
theme_classic()
ggplot()+
geom_point(aes(Cc, sum_vRoot), colour = "#21918c", alpha = 0.1,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "other"))+
geom_point(aes(Cc, sum_vRoot), colour = "#440154" , alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_boxplot(aes(Cc, y = sum_vRoot), colour = "red", alpha = 0.6, data = end_engi)+
geom_hline(aes(yintercept = mean(sum_vRoot)), alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773))
ggplot()+
geom_point(aes(Cc, sum_vRoot), colour = "#21918c", alpha = 0.1,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "other"))+
geom_point(aes(Cc, sum_vRoot), colour = "#440154" , alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_boxplot(aes(Cc, y = sum_vRoot), colour = "red", alpha = 0.6, data = end_engi)+
geom_hline(aes(yintercept = mean(sum_vRoot)), alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773))+
facet_wrap(~soil_type)+
theme_classic()
ggplot()+
geom_point(aes(Cc, sum_vRoot), colour = "#21918c", alpha = 0.1,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "other"))+
geom_point(aes(Cc, sum_vRoot), colour = "#440154" , alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_boxplot(aes(Cc, y = sum_vRoot), colour = "red", alpha = 0.6, data = end_engi)+
geom_hline(aes(yintercept = m), alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773)%>%
dplyr::group_by(soil_type)%>%
dplyr::summarise(m = mean(sum_vRoot))%>%ungroup())+
facet_wrap(~soil_type)+
theme_classic()
ggplot()+
geom_point(aes(Cc, sum_vRoot), colour = "#21918c", alpha = 0.1,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "other"))+
geom_point(aes(Cc, sum_vRoot), colour = "#440154" , alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_boxplot(aes(Cc, y = sum_vRoot), colour = "red", alpha = 0.6, data = end_engi)+
geom_hline(aes(yintercept = m), alpha = 0.5,, size = 2
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773)%>%
ggplot()+
geom_point(aes(Cc, sum_vRoot), colour = "#21918c", alpha = 0.1,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "other"))+
geom_point(aes(Cc, sum_vRoot), colour = "#440154" , alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_boxplot(aes(Cc, y = sum_vRoot), colour = "red", alpha = 0.6, data = end_engi)+
geom_hline(aes(yintercept = m), alpha = 0.5,, size = 2,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773)%>%
dplyr::group_by(soil_type)%>%
dplyr::summarise(m = mean(sum_vRoot))%>%ungroup())+
facet_wrap(~soil_type)+
theme_classic()
ggplot()+
geom_point(aes(Cc, sum_vRoot), colour = "#21918c", alpha = 0.1,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "other"))+
geom_point(aes(Cc, sum_vRoot), colour = "#440154" , alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_boxplot(aes(Cc, y = sum_vRoot), colour = "red", alpha = 0.6, data = end_engi)+
geom_hline(aes(yintercept = m), alpha = 0.5,, size = 2,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773)%>%
dplyr::group_by(soil_type)%>%
dplyr::summarise(m = mean(sum_vRoot))%>%ungroup())+
facet_wrap(~soil_type)+
theme_classic()
ggplot()+
geom_point(aes(Cc, sum_vRoot), colour = "#21918c", alpha = 0.1,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "other"))+
geom_point(aes(Cc, sum_vRoot), colour = "#440154" , alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_boxplot(aes(Cc, y = sum_vRoot), colour = "red", alpha = 0.6, data = end_engi)+
geom_hline(aes(yintercept = m), alpha = 0.5, size = 2,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773)%>%
dplyr::group_by(soil_type)%>%
dplyr::summarise(m = mean(sum_vRoot))%>%ungroup())+
facet_wrap(~soil_type)+
theme_classic()
ggplot()+
geom_boxplot(aes(Cc, sum_vRoot), colour = "#21918c", alpha = 0.1,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "other"))+
geom_boxplot(aes(Cc, sum_vRoot), colour = "#440154" , alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_boxplot(aes(Cc, y = sum_vRoot), colour = "red", alpha = 0.6, data = end_engi)+
geom_hline(aes(yintercept = m), alpha = 0.5, size = 2,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773)%>%
dplyr::group_by(soil_type)%>%
dplyr::summarise(m = mean(sum_vRoot))%>%ungroup())+
facet_wrap(~soil_type)+
theme_classic()
ggplot()+
geom_boxplot(aes("other", sum_vRoot), colour = "#21918c", alpha = 0.1,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "other"))+
geom_boxplot(aes("best", sum_vRoot), colour = "#440154" , alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_boxplot(aes("engineer", y = sum_vRoot), colour = "red", alpha = 0.6, data = end_engi)+
geom_hline(aes(yintercept = m), alpha = 0.5, size = 2,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773)%>%
dplyr::group_by(soil_type)%>%
dplyr::summarise(m = mean(sum_vRoot))%>%ungroup())+
facet_wrap(~soil_type)+
theme_classic()
summary(end_engi$Cc)
ggplot()+
geom_boxplot(aes("other", sum_vRoot), colour = "#21918c", alpha = 0.1,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "other"))+
geom_boxplot(aes("best", sum_vRoot), colour = "#440154" , alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_boxplot(aes("engineer", y = sum_vRoot), colour = "red", alpha = 0.6, data = end_engi)+
geom_hline(aes(yintercept = m), alpha = 0.5, size = 2,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773)%>%
dplyr::group_by(soil_type)%>%
dplyr::summarise(m = mean(sum_vRoot))%>%ungroup())+
facet_wrap(~soil_type)+
theme_classic()
ggplot()+
geom_boxplot(aes("other", sum_vRoot), colour = "#21918c", alpha = 0.1,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "other"))+
geom_boxplot(aes("best", sum_vRoot), colour = "#440154" , alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_boxplot(aes("engineer", y = sum_vRoot), colour = "red", alpha = 0.6, data = end_engi)+
# geom_hline(aes(yintercept = m), alpha = 0.5, size = 2,
#            data = end_crop%>%filter(Cc >= 24595, Cc <= 31773)%>%
#              dplyr::group_by(soil_type)%>%
#              dplyr::summarise(m = mean(sum_vRoot))%>%ungroup())+
facet_wrap(~soil_type)+
theme_classic()
ggplot()+
geom_boxplot(aes("other", sum_vRoot), colour = "#21918c", alpha = 0.1,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "other"))+
geom_boxplot(aes("best", sum_vRoot), colour = "#440154" , alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_boxplot(aes("engineer", y = sum_vRoot), colour = "red", alpha = 0.6, data = end_engi)+
# geom_hline(aes(yintercept = m), alpha = 0.5, size = 2,
#            data = end_crop%>%filter(Cc >= 24595, Cc <= 31773)%>%
#              dplyr::group_by(soil_type)%>%
#              dplyr::summarise(m = mean(sum_vRoot))%>%ungroup())+
facet_wrap(~soil_type)+
xlab("phenotype class")+
theme_classic()
ggplot()+
geom_boxplot(aes("other", sum_vRoot), fill = "#21918c", alpha = 0.1,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "other"))+
geom_boxplot(aes("best", sum_vRoot), fill = "#440154" , alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_boxplot(aes("engineer", y = sum_vRoot), fill = "red", alpha = 0.6, data = end_engi)+
# geom_hline(aes(yintercept = m), alpha = 0.5, size = 2,
#            data = end_crop%>%filter(Cc >= 24595, Cc <= 31773)%>%
#              dplyr::group_by(soil_type)%>%
#              dplyr::summarise(m = mean(sum_vRoot))%>%ungroup())+
facet_wrap(~soil_type)+
xlab("phenotype class")+
theme_classic()
ggplot()+
geom_boxplot(aes("all", sum_vRoot), fill = "#21918c", alpha = 0.1,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773))+
geom_boxplot(aes("best", sum_vRoot), fill = "#440154" , alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_boxplot(aes("engineer", y = sum_vRoot), fill = "red", alpha = 0.6, data = end_engi)+
# geom_hline(aes(yintercept = m), alpha = 0.5, size = 2,
#            data = end_crop%>%filter(Cc >= 24595, Cc <= 31773)%>%
#              dplyr::group_by(soil_type)%>%
#              dplyr::summarise(m = mean(sum_vRoot))%>%ungroup())+
facet_wrap(~soil_type)+
xlab("phenotype class")+
theme_classic()
ggplot()+
geom_boxplot(aes("the whole", sum_vRoot), fill = "#21918c", alpha = 0.1,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773))+
geom_boxplot(aes("best", sum_vRoot), fill = "#440154" , alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_boxplot(aes("engineer", y = sum_vRoot), fill = "red", alpha = 0.6, data = end_engi)+
# geom_hline(aes(yintercept = m), alpha = 0.5, size = 2,
#            data = end_crop%>%filter(Cc >= 24595, Cc <= 31773)%>%
#              dplyr::group_by(soil_type)%>%
#              dplyr::summarise(m = mean(sum_vRoot))%>%ungroup())+
facet_wrap(~soil_type)+
xlab("phenotype class")+
theme_classic()
end = rbind(end_engi, end_crop)
end = rbind(end_engi%>%select(sam, soil_type, sum_vRoot, Cc)%>%mutate(Class = "Engineer"), end_crop%>%
select(sam, soil_type, sum_vRoot, Cc))
end = rbind(end_engi%>%select(sam, soil_type, sum_vRoot, Cc)%>%mutate(Class = "Engineer"), end_crop%>%
select(sam, soil_type, sum_vRoot, Cc,Class))
ggplot()+
geom_boxplot(aes("the whole", sum_vRoot), fill = "#21918c", alpha = 0.1,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773))+
geom_boxplot(aes("best", sum_vRoot), fill = "#440154" , alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_boxplot(aes("engineer", y = sum_vRoot), fill = "red", alpha = 0.6, data = end_engi)+
# geom_hline(aes(yintercept = m), alpha = 0.5, size = 2,
#            data = end_crop%>%filter(Cc >= 24595, Cc <= 31773)%>%
#              dplyr::group_by(soil_type)%>%
#              dplyr::summarise(m = mean(sum_vRoot))%>%ungroup())+
facet_wrap(~soil_type)+
xlab("phenotype class")+
theme_classic()
end = rbind(end_engi%>%select(sam, soil_type, sum_vRoot, Cc)%>%mutate(Class = "Engineer"), end_crop%>%
select(sam, soil_type, sum_vRoot, Cc,Class)%>%filter(Cc >= 24595, Cc <= 31773))
fit = aov(sum_vRoot ~ Class, data = end)
summary(fit)
TuHSD = TukeyHSD(fit)
plot(TuHSD)
fit = aov(sum_vRoot ~ Class*soil_type, data = end)
summary(fit)
TuHSD = TukeyHSD(fit)
plot(TuHSD)
plot(fit)
TuHSD = TukeyHSD(fit)
plot(TuHSD)
ggplot()+
geom_boxplot(aes("the whole", sum_vRoot), fill = "#21918c", alpha = 0.1,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773))+
geom_boxplot(aes("best", sum_vRoot), fill = "#440154" , alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_boxplot(aes("engineer", y = sum_vRoot), fill = "red", alpha = 0.6, data = end_engi)+
# geom_hline(aes(yintercept = m), alpha = 0.5, size = 2,
#            data = end_crop%>%filter(Cc >= 24595, Cc <= 31773)%>%
#              dplyr::group_by(soil_type)%>%
#              dplyr::summarise(m = mean(sum_vRoot))%>%ungroup())+
facet_wrap(~soil_type)+
xlab("phenotype class")+
theme_classic()
fit = aov(sum_vRoot ~ Class*soil_type, data = end)
summary(fit)
fit = aov(sum_vRoot ~ Class+soil_type, data = end)
summary(fit)
TuHSD = TukeyHSD(fit)
plot(TuHSD)
fit = aov(sum_vRoot ~ Class, data = end%>%filter(soil_type == "loam"))
summary(fit)
TuHSD = TukeyHSD(fit)
plot(TuHSD)
fit = aov(sum_vRoot ~ Class, data = end%>%filter(soil_type == "sandy loam"))
summary(fit)
TuHSD = TukeyHSD(fit)
plot(TuHSD)
fit = aov(sum_vRoot ~ Class, data = end%>%filter(soil_type == "silty clay"))
summary(fit)
TuHSD = TukeyHSD(fit)
plot(TuHSD)
ggplot()+
geom_boxplot(aes("the whole", sum_vRoot), fill = "#21918c", alpha = 0.1,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773))+
geom_boxplot(aes("best", sum_vRoot), fill = "#440154" , alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_boxplot(aes("engineer", y = sum_vRoot), fill = "red", alpha = 0.6, data = end_engi)+
# geom_hline(aes(yintercept = m), alpha = 0.5, size = 2,
#            data = end_crop%>%filter(Cc >= 24595, Cc <= 31773)%>%
#              dplyr::group_by(soil_type)%>%
#              dplyr::summarise(m = mean(sum_vRoot))%>%ungroup())+
facet_wrap(~soil_type)+
xlab("phenotype class")+
theme_classic()
ggplot()+
geom_violin(aes("the whole", sum_vRoot), fill = "#21918c", alpha = 0.1,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773))+
geom_violin(aes("best", sum_vRoot), fill = "#440154" , alpha = 0.5,
data = end_crop%>%filter(Cc >= 24595, Cc <= 31773, Class == "best"))+
geom_violin(aes("engineer", y = sum_vRoot), fill = "red", alpha = 0.6, data = end_engi)+
# geom_hline(aes(yintercept = m), alpha = 0.5, size = 2,
#            data = end_crop%>%filter(Cc >= 24595, Cc <= 31773)%>%
#              dplyr::group_by(soil_type)%>%
#              dplyr::summarise(m = mean(sum_vRoot))%>%ungroup())+
facet_wrap(~soil_type)+
xlab("phenotype class")+
theme_classic()
selection1 = c("radius_sem", "radius_lat", "radius_shoot", "aquaporine", "trans_time_apo", "plasmo", "gap")
ggplot()+
geom_line(aes(Time+2, (MeanSq/7168)/var,group = name),
alpha = 0.2, data = Fmod %>%filter(name != "Residuals"))+
geom_line(aes(Time+2, (MeanSq/7168)/var, colour = name), size = 1,
data = Fmod%>%filter(name %in%      selection1))+
viridis::scale_colour_viridis(discrete = T)+facet_wrap(~soil_type, ncol =2)+
theme_dark()+
ylab("First-order sensitivity index")+
xlab("Time (day)")
ggsave("~/Thesis/2020-10 HydraulicViper/GSUA/B73/22_10/sens.svg", width=12, height=10)
# Check the results with the Sobol analysis
S_Data1 = S_Data2 = NULL
for(st in c("loam", "sandy loam", "silty clay")){
tmp = Sobol_series(day_res, Sobol, st)
S_Data1 = rbind(S_Data1, as_tibble(tmp[[1]]))
S_Data2 = rbind(S_Data2, as_tibble(tmp[[2]]))
}
selection1 = c("radius_sem", "radius_lat", "radius_shoot", "aquaporine", "trans_time_apo", "plasmo", "gap")
# Figure with the principal Sobol index
S_Data1 %>%
filter(name %in% selection1 )%>%
mutate(eff = as.numeric(effect),
eff = ifelse(eff <= 0, 0, eff))%>%
ggplot(aes(Time, eff))+
geom_line(aes(colour = name, linetype = main), size = 1)+
facet_wrap(~soil_type)+
ylab("Si")+
theme_dark()+
viridis::scale_colour_viridis(discrete = T)
# Figure with the total Sobol index
S_Data2 %>%
filter(name %in% selection1 )%>%
ggplot()+
geom_line(aes(Time, main, colour = name), size = 1)+
facet_wrap(~soil_type)+
ylab("Si")+
theme_dark()+
viridis::scale_colour_viridis(discrete = T)
S_Data2 %>%
filter(name %in% selection1 )%>%
ggplot()+
geom_line(aes(Time, totlow, colour = name), size = 1, alpha = 0.3)+
geom_line(aes(Time, tot, colour = name), size = 1)+
geom_line(aes(Time, tothigh, colour = name), size = 1, alpha = 0.3)+
facet_wrap(~soil_type)+
ylab("ST")+
theme_dark()+
viridis::scale_colour_viridis(discrete = T)
Sobol <- sobol2007(model = NULL, X1, X2, nboot = 5000)
design2 = Sobol$X
design
design-design2
design$aer-design2$aer
# Check the results with the Sobol analysis
S_Data1 = S_Data2 = NULL
for(st in c("loam", "sandy loam", "silty clay")){
tmp = Sobol_series(day_res, Sobol, st)
S_Data1 = rbind(S_Data1, as_tibble(tmp[[1]]))
S_Data2 = rbind(S_Data2, as_tibble(tmp[[2]]))
}
selection1 = c("radius_sem", "radius_lat", "radius_shoot", "aquaporine", "trans_time_apo", "plasmo", "gap")
# Figure with the principal Sobol index
S_Data1 %>%
filter(name %in% selection1 )%>%
mutate(eff = as.numeric(effect),
eff = ifelse(eff <= 0, 0, eff))%>%
ggplot(aes(Time, eff))+
geom_line(aes(colour = name, linetype = main), size = 1)+
facet_wrap(~soil_type)+
ylab("Si")+
theme_dark()+
viridis::scale_colour_viridis(discrete = T)
# Figure with the total Sobol index
S_Data2 %>%
filter(name %in% selection1 )%>%
ggplot()+
geom_line(aes(Time, main, colour = name), size = 1)+
facet_wrap(~soil_type)+
ylab("Si")+
theme_dark()+
viridis::scale_colour_viridis(discrete = T)
S_Data2 %>%
filter(name %in% selection1 )%>%
ggplot()+
#geom_line(aes(Time, totlow, colour = name), size = 1, alpha = 0.3)+
geom_line(aes(Time, tot, colour = name), size = 1)+
#geom_line(aes(Time, tothigh, colour = name), size = 1, alpha = 0.3)+
facet_wrap(~soil_type)+
ylab("ST")+
theme_dark()+
viridis::scale_colour_viridis(discrete = T)
library(sensitivity)
source("~/Thesis/2020-10 HydraulicViper/GSUA/SobolR.R")
name = c("stele", "radius_sem", "radius_shoot", "radius_lat", "aer", "xylem", "gap", "trans_time_apo", "trans_time_xyl", "kw", "aquaporine", "plasmo")
vals <- list(list(var="stele",dist="unif",params=list(min=-30,max=40)),
list(var="radius_sem",dist="unif",params=list(min=0.200,max=0.400)), # basal root radius equal 75% of tap root
list(var="radius_shoot",dist="unif",params=list(min=0.3,max=0.7)), # first node
list(var="radius_lat",dist="unif",params=list(min=0.1,max=0.1500)), # short laterals, 25% is added for the radius of the long ones
list(var="aer",dist="unif",params=list(min=0,max=0.5)), # proportion of aerenchyma in shootborn root after elongation zone
# list(var="aer_prog",dist="unif",params=list(min=0,max=10)) # delta aerenchyma between initial and base
list(var="xylem",dist="unif",params=list(min=-20,max=20)), # more or less from olometry
list(var="gap",dist="unif",params=list(min=-0.5,max=4)), # what is the length of a maturity zone
list(var="trans_time_apo",dist="unif",params=list(min=1,max=4)), # how long does it take to fully create a apoplastic barrier
list(var="trans_time_xyl",dist="unif",params=list(min=1,max=4)), # how long does it take to have a fully mature metaxylem
list(var="kw",dist="unif",params=list(min=1E-04,max=4E-04)), # wall conductance
#list(var="km",dist="unif",params=list(min=2E-5,max=4E-5)), # membrane conductance whithout aquaporine
list(var="aquaporine",dist="unif",params=list(min=2E-4,max=7.5E-4)), # Change aquaporine conductance
list(var="plasmo",dist="unif",params=list(min=6E-13,max=1E-11))
)
n <- 2^9
detach("package:sensitivity", unload=TRUE)
X1 <- makeMCSample(n,vals, p = 1)%>%
select(-n)
X2 <- makeMCSample(n,vals, p = 2)%>%
select(-n)
library(sensitivity)
Sobol <- sobol2007(model = NULL, X1, X2, nboot = 50)
design <- Sobol$X
design$sam <- 1:nrow(design)
# Check the results with the Sobol analysis
S_Data1 = S_Data2 = NULL
for(st in c("loam", "sandy loam", "silty clay")){
tmp = Sobol_series(day_res, Sobol, st)
S_Data1 = rbind(S_Data1, as_tibble(tmp[[1]]))
S_Data2 = rbind(S_Data2, as_tibble(tmp[[2]]))
}
selection1 = c("radius_sem", "radius_lat", "radius_shoot", "aquaporine", "trans_time_apo", "plasmo", "gap")
# Figure with the principal Sobol index
S_Data1 %>%
filter(name %in% selection1 )%>%
mutate(eff = as.numeric(effect),
eff = ifelse(eff <= 0, 0, eff))%>%
ggplot(aes(Time, eff))+
geom_line(aes(colour = name, linetype = main), size = 1)+
facet_wrap(~soil_type)+
ylab("Si")+
theme_dark()+
viridis::scale_colour_viridis(discrete = T)
# Figure with the total Sobol index
S_Data2 %>%
filter(name %in% selection1 )%>%
ggplot()+
geom_line(aes(Time, main, colour = name), size = 1)+
facet_wrap(~soil_type)+
ylab("Si")+
theme_dark()+
viridis::scale_colour_viridis(discrete = T)
S_Data2 %>%
filter(name %in% selection1 )%>%
ggplot()+
#geom_line(aes(Time, totlow, colour = name), size = 1, alpha = 0.3)+
geom_line(aes(Time, tot, colour = name), size = 1)+
#geom_line(aes(Time, tothigh, colour = name), size = 1, alpha = 0.3)+
facet_wrap(~soil_type)+
ylab("ST")+
theme_dark()+
viridis::scale_colour_viridis(discrete = T)
# Gather all results by time, id and soil type
dynamics = rbind(p_dyna_sand, p_dyna_clay, p_dyna_loam)%>%
dplyr::group_by(sam, soil_type,Time)%>%
dplyr::summarise(vRoot = mean(vRoot),
sum_vRoot = mean(sum_vRoot),
Krs = mean(Krs),
Ksrs = mean(Ksrs),
Cc = mean(Cc))%>%
ungroup()
# Merge the input data on the dataframe
design = read.csv("~/Thesis/2020-10 HydraulicViper/B73design.csv")
results = left_join(dynamics, design, by = "sam")
